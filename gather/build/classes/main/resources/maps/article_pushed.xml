<?xml version="1.0" encoding="gbk" ?>
<!DOCTYPE sqlMap
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="article">

	<typeAlias alias="article" type="com.netease.gather.domain.ArticlePushed" />

	<sql id="_columns">
		topicid, title, docno, pushtime, priority
	</sql>

	<insert id="insertOne" parameterClass="article">
		insert into article_pushed
		(topicid, title, docno, pushtime, priority)
		values(#topicid#,#title#,
		#docno#, #pushtime#, #priority#)
		<selectKey resultClass="long" type="post" keyProperty="autoid">
			select last_insert_id() as value
		</selectKey>
	</insert>

	<update id="updateOne" parameterClass="Map">
		UPDATE article_pushed
		<dynamic prepend="set">
			<isNotEmpty prepend="," property="topicid">
				topicid = #topicid#
			</isNotEmpty>
			<isNotEmpty prepend="," property="title">
				title = #title#
			</isNotEmpty>
			<isNotEmpty prepend="," property="docno">
				docno = #docno#
			</isNotEmpty>
			<isNotEmpty prepend="," property="pushtime">
				pushtime = #pushtime#
			</isNotEmpty>
			<isNotEmpty prepend="," property="priority">
				priority = #priority#
			</isNotEmpty>
		</dynamic>
		WHERE autoid = #autoid#
	</update>

	<sql id="_where">
		<dynamic prepend="where">
			<isNotEmpty prepend="and" property="topicid">
				topicid=#topicid#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="title">
				title=#title#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="docno">
				docno=#docno#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="priority">
				priority=#priority#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="pushtime">
				pushtime=#pushtime#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="starttime">
                <![CDATA[ pushtime>=#starttime#]]>
			</isNotEmpty>
			<isNotEmpty prepend="and" property="endtime">
                <![CDATA[ pushtime<#endtime#]]>
			</isNotEmpty>
		</dynamic>
	</sql>

	<select id="getListByParameters" parameterClass="Map"
		resultClass="article">
		select
		<include refid="_columns" />
		from article_pushed
		<include refid="_where" />
		<isNotEmpty property="order">
            <![CDATA[ order by $order$ ]]>
		</isNotEmpty>
		<dynamic prepend="limit">
			<isNotEmpty property="start">#start#</isNotEmpty>
			<isNotEmpty property="size">, #size#</isNotEmpty>
		</dynamic>
	</select>

	<select id="getArticlesByParams" parameterClass="Map"
		resultClass="article">
		select autoid, topicid, docno, priority,title
		from article_pushed
		<include refid="_where" />
		<dynamic prepend="limit">
			<isNotEmpty property="start">#start#</isNotEmpty>
			<isNotEmpty property="size">, #size#</isNotEmpty>
		</dynamic>
	</select>

	<select id="getDocnoListByParams" parameterClass="Map"
		resultClass="java.lang.String">
		select docno from article_pushed
		<include refid="_where" />
		<isNotEmpty property="order">
            <![CDATA[ order by $order$ ]]>
		</isNotEmpty>
		<dynamic prepend="limit">
			<isNotEmpty property="start">#start#</isNotEmpty>
			<isNotEmpty property="size">, #size#</isNotEmpty>
		</dynamic>
	</select>

	<select id="getCountByParameters" parameterClass="Map"
		resultClass="java.lang.Integer">
		select count(1)
		from article_pushed
		<include refid="_where" />
		<isNotEmpty property="order">
            <![CDATA[ order by $order$ ]]>
		</isNotEmpty>
		<dynamic prepend="limit">
			<isNotEmpty property="start">#start#</isNotEmpty>
			<isNotEmpty property="size">, #size#</isNotEmpty>
		</dynamic>
	</select>

	<select id="getOneByParameters" parameterClass="Map"
		resultClass="article">
		select
		<include refid="_columns" />
		from article_pushed
		<include refid="_where" />
	</select>

	<delete id="deleteSomeByParameters" parameterClass="Map">
		delete
		from article_pushed
		<include refid="_where" />
	</delete>

</sqlMap>
